
var file1 = "C:\\Gravações\\2023\\Novembro\\13 habitos que revelam personalidade - 2023-11-07 15-16-52_RAW.mp4";
var nomeDoTrabalho = "MD-025 13 habitos que revelam personalidade";

var removeDualAudioTracks = false;

var cortes = [

[0.000, 3.724], [4.030, 6.099], [6.850, 10.761], 
[11.078, 12.324], [13.148, 16.674], [17.131, 18.693], [19.070, 21.152], [21.496, 23.057], [23.588, 26.191], [26.774, 27.683], [28.411, 30.050], [30.390, 32.171], [32.624, 34.029], [34.425, 38.520], [38.934, 41.428], [42.095, 43.226], [43.810, 44.335], [44.809, 49.766], [50.175, 53.704], [54.398, 55.812], [56.189, 57.921], [58.380, 61.423], [61.956, 64.434], [65.140, 69.369], [69.837, 72.285], [72.933, 74.337], [75.226, 78.886], [79.350, 80.597], [80.934, 84.556], [85.029, 87.841], [88.590, 92.872], [93.506, 94.215], [95.289, 100.548], [101.099, 105.067], [105.673, 107.226], [107.659, 112.028], [112.402, 114.653], [115.057, 118.688], [119.106, 123.565], [123.976, 128.462], [129.549, 131.059], [131.435, 134.033], [135.042, 137.548], [137.895, 141.948], [142.340, 144.138], [144.573, 145.124], [145.750, 148.370], [148.700, 152.107], [152.860, 155.527], [158.320, 158.976], [159.599, 164.515], [164.928, 165.582], [165.898, 168.441], [169.088, 172.733], [173.220, 175.246], [175.584, 178.200], [179.205, 179.750], [180.211, 181.352], [181.690, 183.034], [183.399, 188.216], [188.669, 189.895], [190.257, 192.678], [193.004, 193.596], [193.970, 196.120], [196.435, 198.684], [199.185, 203.852], [204.407, 209.462], [209.856, 214.365], [214.893, 217.135], [217.461, 220.601], [221.054, 226.601], [227.169, 228.539], [230.021, 233.110], [233.758, 236.401], [236.982, 244.562], [245.032, 247.590], [247.981, 251.678], [252.463, 257.862], [258.245, 259.591], [259.930, 260.520], [261.634, 262.288], [262.590, 264.158], [264.614, 266.168], [266.753, 267.267], [267.700, 270.510], [271.730, 278.455], [279.417, 280.726], [281.133, 286.420], [286.843, 290.089], [290.456, 293.701], [294.078, 298.317], [298.740, 303.130], [303.910, 303.912], [305.439, 306.955], [307.558, 308.232], [309.095, 310.124], [310.580, 313.706], [314.200, 317.266], [317.622, 319.192], [319.945, 322.125], [323.017, 323.639], [323.961, 328.192], [328.503, 331.797], [332.144, 333.882], [335.534, 337.005], [347.468, 349.346], [349.713, 353.483], [353.834, 356.088], [356.721, 360.366], [360.787, 362.484], [362.941, 365.315], [365.733, 368.113], [369.224, 371.353], [372.080, 373.509], [374.093, 374.678], [375.416, 376.138], [376.693, 377.968], [378.667, 380.537], [381.218, 382.271], [382.629, 383.130], [385.067, 386.047], [389.349, 392.224], [392.679, 393.472], [393.918, 396.067], [396.459, 403.413], [404.149, 410.815], [411.255, 411.967], [412.339, 413.432], [414.192, 419.146], [419.513, 422.475], [423.014, 425.876], [426.386, 431.546], [431.892, 435.240], [435.766, 439.438], [439.752, 442.101], [442.922, 445.469], [445.963, 451.521], [452.147, 455.075], [455.489, 458.578], [458.899, 464.526], [464.937, 468.109], [468.518, 472.510], [472.862, 476.337], [477.282, 492.947], [493.249, 497.344], [497.783, 502.496], [502.971, 503.819], [504.181, 505.216], [505.751, 507.192], [507.649, 508.443], [508.887, 515.894], [516.261, 518.070], [518.595, 521.403], [522.383, 524.023], [524.365, 526.015], [526.544, 530.539], [530.957, 531.899], [532.474, 533.142], [533.467, 534.444], [534.763, 536.032], [536.611, 540.482], [541.152, 546.131], [546.548, 547.346], [547.908, 550.873], [551.205, 553.255], [553.730, 555.220], [555.527, 558.212], [559.134, 559.780], [560.994, 567.841], [568.284, 570.631], [571.388, 576.372], [576.830, 578.187], [579.008, 580.260], [580.856, 584.682], [585.163, 590.012], [590.439, 594.021], [594.453, 598.541], [599.585, 601.086], [603.088, 605.731], [606.088, 609.883], [610.236, 615.712], [616.415, 622.047], [622.373, 624.810], [625.285, 628.696], [629.093, 635.217], [635.797, 636.605], [637.043, 638.287], [638.998, 640.872], [641.291, 644.717], [645.094, 648.588], [650.299, 656.015], [656.681, 665.061], [665.564, 670.719], [671.058, 671.442], [672.985, 675.191], [675.543, 681.605], [682.001, 683.290], [683.958, 688.787], [689.397, 690.535], [691.532, 695.827], [696.441, 697.373], [698.173, 701.914], [702.572, 707.591], [709.324, 711.619], [711.991, 713.031], [714.537, 715.584], [716.128, 718.730], [719.127, 720.386], [720.785, 727.944], [728.330, 732.146], [733.976, 736.119], [736.764, 741.033], [741.734, 742.755], [744.791, 745.348], [745.776, 749.203], [749.629, 750.148], [750.459, 751.862], [752.230, 753.401], [753.802, 754.878], [755.373, 758.042], [759.155, 760.771], [761.443, 764.913], [765.950, 769.155], [769.596, 771.982], [773.469, 775.915], [777.759, 777.762], [778.868, 784.304], [785.080, 787.093], [787.400, 788.306], [789.132, 790.646], [791.316, 795.239], [795.649, 798.261], [798.575, 801.252], [801.716, 803.093], [803.518, 809.286], [809.734, 811.160], [811.749, 815.190], [816.157, 820.115], [820.610, 822.370], [822.678, 826.616], [827.062, 832.261], [832.626, 835.522], [835.912, 837.399], [837.805, 841.335], [841.757, 844.339], [850.496, 853.699], [854.441, 861.189], [861.553, 863.158], [863.608, 867.923], [868.384, 871.333], [871.805, 876.982], [877.706, 880.635], [881.003, 883.752], [885.750, 888.109], [888.721, 889.290], [889.633, 893.286], [893.596, 895.668], [896.032, 899.751], [900.055, 903.769], [904.210, 910.072], [910.375, 913.297], [913.628, 914.789], [915.145, 915.298], [928.601, 931.687], [932.030, 933.755], [934.094, 936.242], [940.145, 943.365], [943.711, 945.218], [945.615, 948.456], [948.816, 949.436], [949.737, 952.535], [952.843, 955.380], [955.690, 958.477], [958.932, 963.167], [963.471, 964.298], [964.629, 965.253], [967.310, 969.601], [969.921, 973.439], [973.792, 975.069], [975.468, 977.915], [978.247, 981.822], [987.290, 996.476]

];


alert("O Script de Melhoria");

var pastaDeTrabalho = app.project.rootItem.createBin(nomeDoTrabalho);
app.project.importFiles([file1], false, pastaDeTrabalho);

var itemImportado = pastaDeTrabalho.children[0];
var sequencia = app.project.createNewSequenceFromClips(nomeDoTrabalho,   [itemImportado]   , pastaDeTrabalho)

//app.project.activeSequence.videoTracks[0].insertClip(backsBin.children[0], 0);
if (removeDualAudioTracks){
    app.project.activeSequence.audioTracks[1].clips[0].remove(1,1);
}

var activeCips = 0;
var inicio = 0;
var fim = 0;
var clipEnds = 0;

activeCips = 0;
inicio = new Time().seconds = cortes[0][0];
fim = new Time().seconds = cortes[0][1];
clipEnds = fim - inicio;

$.writeln("Posição; Inicio; Fim; Duração; Ends");
$.writeln(0 + ";" + inicio + ";" + fim + ";" + 0 + ";");

app.project.activeSequence.videoTracks[0].clips[activeCips].inPoint = inicio;
app.project.activeSequence.audioTracks[0].clips[activeCips].inPoint = inicio;

app.project.activeSequence.videoTracks[0].clips[activeCips].end = clipEnds;
app.project.activeSequence.audioTracks[0].clips[activeCips].end = clipEnds;


for (x = 1; x< cortes.length; x++){

    inicio = new Time().seconds = cortes[x][0];
    fim = new Time().seconds = cortes[x][1];
     
    //SOFT CUT
    //inicio = inicio - 0.043;
    //fim    = fim    + 0.043;

    inicio = inicio - 0.150;
    fim    = fim    + 0.150;
    //--------------------------------- 

    //Verificando se o vídeo é muito curto para ser cortado.
    if (inicio < fim  &&  fim-inicio > 0.085){
    
        activeCips = activeCips + 1;
        posicao = parseFloat(  clipEnds.toFixed(3) );

        //$.writeln("Passada:"  + posicao + ";" );
        $.writeln(x + ";" + inicio + ";" + fim + ";" + posicao + ";");

        app.project.activeSequence.videoTracks[0].insertClip( itemImportado, posicao );
        
        if (removeDualAudioTracks){
            app.project.activeSequence.audioTracks[1].clips[0].remove(1,1); 
        }
    
        clipEnds = (fim - inicio) + posicao; 

        app.project.activeSequence.videoTracks[0].clips[activeCips].inPoint = inicio;
        app.project.activeSequence.audioTracks[0].clips[activeCips].inPoint = inicio;

        app.project.activeSequence.videoTracks[0].clips[activeCips].end = clipEnds;
        app.project.activeSequence.audioTracks[0].clips[activeCips].end = clipEnds;

    }
    else {
        $.writeln("Marcação INICIO FIM Invalidos" +  fim - inicio);
    }

    
}

$.writeln("Finalizando o Recorte do Clip" + clipEnds);
app.project.activeSequence.setOutPoint(clipEnds);


function secs(valor){
    return new Time().seconds = valor;
}

function hMSToS(hora, minutos, segundos){
        return (hora*60*60)+(minutos*60)+segundos;
}



